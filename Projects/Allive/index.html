<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Allive - 함께하는 세상 올리브 | JS Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="JeongShin 의 코딩 블로그 👨🏻‍💻">
    <meta name="google-site-verification" content="66JKoxw93huqhAdXO3P0K86NJZne5H-M3302YHcwoWI">
    <link rel="preload" href="/JeongShin_Blog/assets/css/0.styles.71ccf4c7.css" as="style"><link rel="preload" href="/JeongShin_Blog/assets/js/app.48ae690c.js" as="script"><link rel="preload" href="/JeongShin_Blog/assets/js/2.42bebd90.js" as="script"><link rel="preload" href="/JeongShin_Blog/assets/js/4.dc3b17c2.js" as="script"><link rel="prefetch" href="/JeongShin_Blog/assets/js/10.12eed9e1.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/11.f2d2842e.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/12.dfa48675.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/13.ee731d90.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/14.8cc6ab5d.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/15.f93ca875.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/16.f61d1a48.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/17.1499d9e2.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/18.6e3ea3eb.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/19.75994228.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/20.7e164683.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/21.f3c05e85.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/22.2fcf42b4.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/23.bb7fe255.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/24.4888925c.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/3.26b6bd5c.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/5.e8d6299d.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/6.14982bbc.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/7.6e8762b4.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/8.f3a43964.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/9.c81f3e4d.js">
    <link rel="stylesheet" href="/JeongShin_Blog/assets/css/0.styles.71ccf4c7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/JeongShin_Blog/" class="home-link router-link-active"><img src="/JeongShin_Blog/images/logo.jpg" alt="JS Blog" class="logo"> <span class="site-name can-hide">JS Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/JeongShin_Blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/JeongShin_Blog/home/" class="nav-link">
  
</a></div><div class="nav-item"><a href="/JeongShin_Blog/aboutme/" class="nav-link">
  About me
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/JeongShin_Blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/JeongShin_Blog/home/" class="nav-link">
  
</a></div><div class="nav-item"><a href="/JeongShin_Blog/aboutme/" class="nav-link">
  About me
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/JeongShin_Blog/guide/" class="sidebar-link">Guide</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/JeongShin_Blog/Projects/" class="sidebar-heading clickable router-link-active open"><span>Projects</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/JeongShin_Blog/Projects/Allive/" aria-current="page" class="active sidebar-link">Allive - 함께하는 세상 올리브</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JeongShin_Blog/Projects/Allive/#intro-프로젝트-소개" class="sidebar-link">Intro. 프로젝트 소개</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/Projects/Allive/#note-1-custom-event" class="sidebar-link">Note 1. Custom Event</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/Projects/Allive/#note-2-toast-만들기" class="sidebar-link">Note 2. Toast 만들기</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/JeongShin_Blog/algorithms/" class="sidebar-heading clickable"><span>Algorithms</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="allive-함께하는-세상-올리브"><a href="#allive-함께하는-세상-올리브" class="header-anchor">#</a> Allive - 함께하는 세상 올리브</h1> <h2 id="intro-프로젝트-소개"><a href="#intro-프로젝트-소개" class="header-anchor">#</a> Intro. 프로젝트 소개</h2> <p>올리브 프로젝트 소개 및 프론트 엔드 개발 회고 입니다 😁</p> <p>프론트엔드 개발하면서 있었던 <strong>크고 작은 고민에 대한 회고</strong>를 남겨두기 위함 입니다 ✍️</p> <h4 id="올리브는-어떤-프로젝트-인가요-🙋🏻"><a href="#올리브는-어떤-프로젝트-인가요-🙋🏻" class="header-anchor">#</a> 올리브는 어떤 프로젝트 인가요 🙋🏻</h4> <p>올리브 프로젝트 (<strong>Allive</strong>, <strong>All Live Together</strong>)는 2021년 3월부터 기획 및 기술 스택 스터디, 9월부터 본격적인 개발에 들어간 <strong>재능나눔 어플</strong> 프로젝트 입니다.</p> <p>대학교 4학년 개발자 2명이서 학과 공부 및 회사 업무와 병행하며 퇴근 후, 주말 시간 등을 활용하여 열정을 불 태우며 개발중인 프로젝트 입니다. 🔥</p> <div class="center"><img src="/JeongShin_Blog/assets/img/allive_guide_3.c0a753c1.png" width="300" height="auto"> <img src="/JeongShin_Blog/assets/img/allive_guide_1.acb18f2c.png" width="300" height="auto"> <img src="/JeongShin_Blog/assets/img/allive_guide_2.7fb6658a.png" width="300" height="auto"></div> <p>개발자 소개 입니다.</p> <ul><li><p>👨🏻‍💻 프론트 엔드 개발 - 신정웅 <a href="https://github.com/JeongShin" target="_blank" rel="noopener noreferrer">github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>👨🏻‍💻 백엔드 개발 - 이신육 <a href="https://github.com/leeshinyook" target="_blank" rel="noopener noreferrer">github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <h4 id="프론트엔드-app-기술스택"><a href="#프론트엔드-app-기술스택" class="header-anchor">#</a> 프론트엔드 App 기술스택</h4> <ul><li><p>React Native</p></li> <li><p>Styled Components Native</p></li> <li><p>Recoil js</p></li> <li><p>Firebase (Cloud Messaging, Crashlytics, Analytics)</p></li></ul> <h4 id="프론트엔드-web-기술스택"><a href="#프론트엔드-web-기술스택" class="header-anchor">#</a> 프론트엔드 Web 기술스택</h4> <ul><li>Next js</li></ul> <h4 id="백엔드-기술스택"><a href="#백엔드-기술스택" class="header-anchor">#</a> 백엔드 기술스택</h4> <ul><li><p>Java Spring</p></li> <li><p>AWS - elasticsearch</p></li> <li><p>Swagger</p></li> <li><p>TODO</p></li></ul> <h4 id="프로젝트-진행상황"><a href="#프로젝트-진행상황" class="header-anchor">#</a> 프로젝트 진행상황</h4> <table><thead><tr><th></th> <th>iOS</th> <th>Android</th> <th>Web</th></tr></thead> <tbody><tr><td>1차 배포 - 버전 1.0</td> <td>배포 완료 ✅</td> <td>심사진행중 💭</td> <td>개발중 👷🏻</td></tr> <tr><td>2차 배포 - 버전 1.1</td> <td>2021.12 예정</td> <td>2021.12 예정</td> <td>2021.12 예정</td></tr></tbody></table> <p>2차 배포를 마무리로 프로젝트 마무리 될 예정 입니다.</p> <h2 id="note-1-custom-event"><a href="#note-1-custom-event" class="header-anchor">#</a> Note 1. Custom Event</h2> <p>RN 환경에서 개발을 하다가 <code>Custom Event</code> 를 발생시켜야 하는 상황이 생겼다.</p> <p>인스타그램과 같은 앱에서 하단 탭을 여러번 탭하거나 로고를 누르는 경우 스크롤을 쭉 올려주는 구현을 하고 싶었다.</p> <h3 id="문제점"><a href="#문제점" class="header-anchor">#</a> 문제점</h3> <ul><li>하단 탭 컴포넌트와 리스트 컴포넌트가 완전히 분리된 컴포넌트이기 때문에 소통할 수 있는 구조가 아니였다.</li> <li>Node Module <strong>events</strong> 를 사용해서 커스텀 이벤트를 발생시켜 구현하고 싶었지만 React Native 환경에서는 기본 모듈이 없다.</li> <li>다른 라이브러리 찾아서 쓸까 고민 했지만 그냥 커스텀으로 만들어 보기로 결정했다.</li> <li>RN 코어 라이브러리를 제외하고는 다른 라이브러리 사용을 최소화하기 위한 노력이다.. ㅎㅎ</li></ul> <h3 id="해결방안"><a href="#해결방안" class="header-anchor">#</a> 해결방안</h3> <p>일단 기본적인 <code>addEventListener</code> 와 클린업을 위한 <code>removeEventListener</code> 만 러프하게 작성해보았다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code>type <span class="token function-variable function">Callback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">args<span class="token operator">?</span><span class="token operator">:</span> unknown</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">EventClass</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> Listeners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> Callback<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> <span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string<span class="token punctuation">,</span> callback<span class="token operator">:</span> Callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>isNameString<span class="token punctuation">,</span> isCallbackFn<span class="token punctuation">,</span> isExists<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token keyword">typeof</span> name <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">,</span>
      <span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">,</span>
      EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isNameString <span class="token operator">||</span> <span class="token operator">!</span>isCallbackFn <span class="token operator">||</span> isExists<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

    EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> name <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string<span class="token punctuation">,</span> args<span class="token operator">?</span><span class="token operator">:</span> unknown</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> callback <span class="token operator">=</span> EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> EventClass<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>이제 BottomTabs 에서 같은 탭을 두번 클릭하게 되는 경우 이벤트를 발생 시킨다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Event <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@all-live'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> BottomTabBar<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token constant">FC</span><span class="token operator">&lt;</span>BottomTabBarProps<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> navigation<span class="token punctuation">,</span> state <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> onTabPressHandler <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">currIdx<span class="token operator">:</span> number<span class="token punctuation">,</span> idx<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currIdx <span class="token operator">!==</span> idx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        navigation<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>routes<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currIdx <span class="token operator">===</span> <span class="token constant">BOTTOM_TABS</span><span class="token punctuation">.</span><span class="token constant">HOME_TAB_SCREEN</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 두번 연속으로 같은 탭을 탭하는 경우 이벤트 발생</span>
        Event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'scrollFlatListToTop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 생략</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>리스트 컴포넌트에선 이벤트 리스너를 등록해준다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Event <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@all-live'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> AllTalentList<span class="token operator">:</span> <span class="token constant">FC</span><span class="token operator">&lt;</span>AllTalentListProps<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> navigation <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> flatListRef <span class="token operator">=</span> useRef<span class="token operator">&lt;</span>FlatList<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> onScrollToTopHandler <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    flatListRef<span class="token punctuation">.</span>current<span class="token operator">?.</span><span class="token function">scrollToOffset</span><span class="token punctuation">(</span><span class="token punctuation">{</span> animated<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> offset<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 이벤트 리스너 등록</span>
    Event<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scrollFlatListToTop'</span><span class="token punctuation">,</span> onScrollToTopHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 클린업</span>
      Event<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'scrollFlatListToTop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 생략</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>동작이 잘되는걸 확인하고 나서 타입 적용을 시작했다.</p> <p>목표는 아래와 같다.</p> <ol><li><p>이벤트 이름 강제 시</p></li> <li><p>이벤트 이름에 따라 콜백에 인자가 있는 경우 인자 타입 정의</p></li></ol> <p>코드가 그렇게 길지 않아서 전체코드를 올리자면</p> <div class="language-TS line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 여기 인터페이스를 기반으로 인자 타입을 결정 해준다.</span>
<span class="token keyword">interface</span> <span class="token class-name">CustomEvents</span> <span class="token punctuation">{</span>
  <span class="token comment">// 이벤트 이름: 인자 타입</span>
  scrollFlatListToTop<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Callback<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">args<span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> EventNames <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token keyword">keyof</span> CustomEvents<span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">EventClass</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> Listeners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> addEventListener<span class="token operator">&lt;</span>EventName <span class="token keyword">extends</span> <span class="token class-name">keyof</span> CustomEvents <span class="token operator">=</span> EventNames<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    name<span class="token operator">:</span> EventName<span class="token punctuation">,</span>
    callback<span class="token operator">:</span> Callback<span class="token operator">&lt;</span>CustomEvents<span class="token punctuation">[</span>EventName<span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>isNameString<span class="token punctuation">,</span> isCallbackFn<span class="token punctuation">,</span> isExists<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token keyword">typeof</span> name <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">,</span>
      <span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">,</span>
      EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isNameString <span class="token operator">||</span> <span class="token operator">!</span>isCallbackFn <span class="token operator">||</span> isExists<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

    EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> EventNames</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> name <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">removeAllEventListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> emit<span class="token operator">&lt;</span>EventName <span class="token keyword">extends</span> <span class="token class-name">keyof</span> CustomEvents <span class="token operator">=</span> EventNames<span class="token operator">&gt;</span><span class="token punctuation">(</span>name<span class="token operator">:</span> EventName<span class="token punctuation">,</span> args<span class="token operator">?</span><span class="token operator">:</span> CustomEvents<span class="token punctuation">[</span>EventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> callback <span class="token operator">=</span> EventClass<span class="token punctuation">.</span>Listeners<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> EventClass<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>와 같이 해주었고 타입 적용이 잘 되고 있는지 확인 해보았다.</p> <p>타입이 잘 적용 되는지 테스트 하기 위해 인터페이스를 아래와 같이 변경</p> <div class="language-TS line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">CustomEvents</span> <span class="token punctuation">{</span>
  scrollFlatListToTop<span class="token operator">:</span> <span class="token punctuation">{</span> myParam<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>emit 하는 부분</strong></p> <div class="center"><img src="/JeongShin_Blog/assets/img/type_test1.d21debdd.png" width="100%" height="auto"></div> <p><strong>callback 등록하는 부분</strong></p> <div class="center"><img src="/JeongShin_Blog/assets/img/type_test2.d6f309e1.png" width="100%" height="auto"></div> <p>잘된다 ㅎㅎ</p> <h3 id="결과"><a href="#결과" class="header-anchor">#</a> 결과</h3> <p>거의 뇌피셜로 구현해서 이렇게 하는게 맞는지 모르겠는데 기능은 대충 흉내낸거 같다.</p> <div class="center"><img src="/JeongShin_Blog/assets/img/custom_events.gif.7801c768.gif" width="300" height="600"></div> <h2 id="note-2-toast-만들기"><a href="#note-2-toast-만들기" class="header-anchor">#</a> Note 2. Toast 만들기</h2> <p>Toast Modal 을 커스텀하게 제작해서 사용하고 있는데 문제점이 있었다.</p> <h3 id="문제점-🚨"><a href="#문제점-🚨" class="header-anchor">#</a> 문제점 🚨</h3> <p>Toast Modal 이 떠있는 동안 화면을 제어하지 못한다.</p> <p>문제가 발생한 이유는 <code>navigation</code> 을 이용해서 <strong>transparent modal</strong> 로 화면 이동을 해서 하는 방식으로 구현을 했는데 아래 요구사항을 쉽게 만족하기 위해서였다.</p> <h3 id="요구사항-💭"><a href="#요구사항-💭" class="header-anchor">#</a> 요구사항 💭</h3> <div class="language- extra-class"><pre><code>✅ Toast Modal 이 생겼다가 일정시간 이후 자동으로 사라져야함
✅ 애니매이션 (fade in, out) 효과가 있어야함
✅ 화면 뒤에 컨텐츠가 보여야 함
❌ 화면 제어가 가능해야함 → 문제 발생😱
</code></pre></div><p>4번 문제를 일단 냅두고 1차 배포를 했는데 이제 해결하기 위한 방법을 생각해보았다.</p> <h3 id="해결방안-🤔"><a href="#해결방안-🤔" class="header-anchor">#</a> 해결방안 🤔</h3> <p>기존 방식은 아래와 같이 navigation 을 통한 화면 이동이였다. 해당 방식으로는 애니메이션을 따로 코딩하지 않고 구현할 수 있어서 하였는데 4번 문제를 해결 할 수 없었다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code>navigation<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token string">'TOAST_MODAL'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> body<span class="token operator">:</span> <span class="token constant">TOAST_MESSAGES</span><span class="token punctuation">.</span><span class="token constant">TALENT</span><span class="token punctuation">.</span><span class="token constant">LIKED</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>제일 처음 떠올린 해결방안은 navigation 을 통한 화면 이동이 아닌 작은 컴포넌트를 띄워주는 방식으로 해결 하고자 하였다.</p> <p>부모 컴포넌트가 자식 컴포넌트를 제어해야하기 때문에 <strong><code>useImperativeHandle</code></strong> 을 활용 하였다.</p> <p>전체 코드는 아래와 같다.</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Timer <span class="token operator">=</span> ReturnType<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeof</span> <span class="token attr-name">setTimeout</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">;

const TOAST_TIMEOUT_IN_MS = 1200;

const Toast = forwardRef</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ToastRef</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">((_, ref) =&gt; </span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> timer <span class="token operator">=</span> useRef<span class="token operator">&lt;</span>Timer <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> isAnimating <span class="token operator">=</span> useRef<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>boolean</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(false);
  const </span><span class="token punctuation">{</span> bottomInset <span class="token punctuation">}</span><span class="token plain-text"> = useSafeArea();
  const animation = useRef(new Animated.Value(0)).current;

  const [body, setBody] = useState&lt;string | null&gt;(null);
  const [margin, setMargin] = useState</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(0);

  const doneAnimatingCallback = useCallback(() =&gt; </span><span class="token punctuation">{</span>
    isAnimating<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">setBody</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token plain-text">, []);

  const timeOutHandler = useCallback(() =&gt; </span><span class="token punctuation">{</span>
    Animated<span class="token punctuation">.</span><span class="token function">timing</span><span class="token punctuation">(</span>animation<span class="token punctuation">,</span> <span class="token punctuation">{</span> toValue<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> duration<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> useNativeDriver<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>
      doneAnimatingCallback
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token plain-text">, []);

  const onShowHandler = useCallback((toastProps: ToastProps) =&gt; </span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> timeOutInMs <span class="token operator">=</span> <span class="token constant">TOAST_TIMEOUT_IN_MS</span><span class="token punctuation">,</span> body<span class="token operator">:</span> toastBody <span class="token punctuation">}</span> <span class="token operator">=</span> toastProps<span class="token punctuation">;</span>
    <span class="token comment">// 이미 다른 toast 가 animating 중인 경우 다른 toast 는 억제</span>
    <span class="token comment">// 1. 큐에 넣어서 하나씩 처리할까 생각했지만 애매해서 중단</span>
    <span class="token comment">// 2. 기존 toast 를 취소하고 새로운 toast 를 띄워주는 방식도 가능할듯</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isAnimating<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    isAnimating<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token function">setBody</span><span class="token punctuation">(</span>toastBody<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Animated<span class="token punctuation">.</span><span class="token function">timing</span><span class="token punctuation">(</span>animation<span class="token punctuation">,</span> <span class="token punctuation">{</span> toValue<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> duration<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span> useNativeDriver<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>timeOutHandler<span class="token punctuation">,</span> timeOutInMs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token plain-text">, []);

  const imperativeHandler = useCallback(
    () =&gt; (</span><span class="token punctuation">{</span>
      show<span class="token operator">:</span> onShowHandler
    <span class="token punctuation">}</span><span class="token plain-text">),
    []
  );

  const onBodyLayoutHandler = useCallback((event: LayoutChangeEvent) =&gt; </span><span class="token punctuation">{</span>
    <span class="token comment">// container left margin 을 계산하기 위함</span>
    <span class="token keyword">const</span> containerWidth <span class="token operator">=</span> event<span class="token punctuation">.</span>nativeEvent<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> containerWidth <span class="token operator">!==</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token function">setMargin</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">DIMENSIONS</span><span class="token punctuation">.</span><span class="token constant">WIDTH</span> <span class="token operator">-</span> containerWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token plain-text">, []);

  useImperativeHandle(ref, imperativeHandler, []);

  return (
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>body <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ToastStyle.Container</span></span>
          <span class="token attr-name">as</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>Animated<span class="token punctuation">.</span>View<span class="token punctuation">}</span></span>
          <span class="token attr-name">leftMargin</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>margin<span class="token punctuation">}</span></span>
          <span class="token attr-name">bottomInset</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>bottomInset<span class="token punctuation">}</span></span>
          <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> opacity<span class="token operator">:</span> animation <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ToastStyle.BodyView</span></span> <span class="token attr-name">onLayout</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onBodyLayoutHandler<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GlobalText.TextSmall</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>whiteColor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>body<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">GlobalText.TextSmall</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ToastStyle.BodyView</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ToastStyle.Container</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  );
});

const ToastStyle = </span><span class="token punctuation">{</span>
  Container<span class="token operator">:</span> Styled<span class="token punctuation">.</span>View<span class="token operator">&lt;</span>SafeAreaInsets <span class="token operator">&amp;</span> <span class="token punctuation">{</span> leftMargin<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    position: absolute;
    bottom: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> bottomInset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> theme <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> theme<span class="token punctuation">.</span>bottomTabBarHeight <span class="token operator">+</span> bottomInset <span class="token operator">+</span> <span class="token number">16</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px;
    margin-left: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> leftMargin <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> leftMargin<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  BodyView<span class="token operator">:</span> Styled<span class="token punctuation">.</span>View<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    border-radius: 8px;
    background-color: #000000aa;
    padding: 16px;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token plain-text">;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br></div></div><p>각각 요구사항에 대한 구현은 아래와 같이 진행함!</p> <ol><li><p>Toast Modal 이 생겼다가 일정시간 이후 자동으로 사라져야함</p> <p><code>imperativeHandler</code> 를 통해 부모 컴포넌트에서 <strong>onShowHandler</strong> 를 호출할 수 있도록 세팅,</p> <p><strong>setBody</strong> 를 통해 뷰가 나타나도록 하고 <strong>Animated API</strong> 를 통해 opacity 애니메이션으로 fade in 효과 구현</p> <p>animation 은 useNativeDriver 를 통해 네이티브로 넘김</p> <p>setTimeOut 을 통해 fade out animation 호출 후 콜백으로 다음 애니메이션 가능하도록 isAnimating 값 업데이트</p></li> <li><p>애니매이션 (fade in, out) 효과가 있어야함</p> <p>위에 설명한 <strong>Animated API</strong> 로 해결!</p></li> <li><p>화면 뒤에 컨텐츠가 보여야 함</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">const</span> CategoryTabScreen<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token constant">FC</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryTabScreenProps</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = ({ navigation }) =&gt; </span><span class="token punctuation">{</span>
  <span class="token comment">// toast 제어하기 위한 ref</span>
  <span class="token keyword">const</span> toastRef <span class="token operator">=</span> useRef <span class="token operator">&lt;</span> ToastRef <span class="token operator">&gt;</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> likePressHandler <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">subCategoryLikeInfo<span class="token operator">:</span> SubCategoryLikeInfo</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// 생략</span>
        <span class="token comment">// show handler 호출</span>
        toastRef<span class="token punctuation">.</span>current<span class="token operator">?.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          body<span class="token operator">:</span> <span class="token function">getCategoryLikeToastBody</span><span class="token punctuation">(</span>subCategoryLikeInfo<span class="token punctuation">,</span> result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 생략</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SafeAreaView</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">OtherComponents</span></span> <span class="token attr-name">likePressHandler</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>likePressHandler<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* SafeAreaView 에서 가장 앞쪽에 노출 되도록 */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Toast</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toastRef<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">SafeAreaView</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token plain-text">;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></li> <li><p>화면 제어가 가능해야함 👉 핵심 이슈!</p></li></ol> <p>Container 컴포넌트를 width: 100% 로 Text 컴포넌트를 margin: 0 auto 와 같이 해줄 수 있지만 아래 그림과 같은 영역 터치가 불가능 해진다.</p> <div class="center"><img src="/JeongShin_Blog/assets/img/toast.5b836feb.png" width="300" height="auto"></div> <p>따라서 container width 는 토스트 가로 길이에 딱 맞도록 하고 margin-left 속성을 동적으로 조절 해주는 방향으로 진행했다. 토스트를 제외한 모든 영역 터치가 가능하게 하도록 하기 위함이다.</p> <p><code>onBodyLayoutHandler</code> 를 통해 body 에 따른 뷰의 가로 길이를 계산해서 container margin-left 값을 동적으로 조절.</p> <div class="center"><img src="/JeongShin_Blog/assets/img/toast_screen.2277a9a0.png" width="300" height="auto"></div> <p>잘 적용된 모습. 끝~!</p> <p><s>개발자 입장에선 많은 변화가 있었지만 사용자들은 해당 이슈가 있는지도 모를때가 많다..ㅎㅎ</s></p> <p>그래도 나만 만족하면 됨</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/JeongShin_Blog/guide/" class="prev">
        Guide
      </a></span> <span class="next"><a href="/JeongShin_Blog/algorithms/Problems/">
        알고리즘 정리 노트
      </a>
      →
    </span></p></div>  <div><div id="comment"></div></div></main> <footer class="siteFooter">
  COPYRIGHT©2020 ALL RIGHT JeongShin
  <br>sjeong1127@gmail.com . +82-10-2169-2142 .
  <br> <a href="https://www.instagram.com/jeongshin96/" target="_blank">Instagram</a> <a href="https://github.com/JeongShin" target="_blank">GitHub</a></footer></div><div class="global-ui"></div></div>
    <script src="/JeongShin_Blog/assets/js/app.48ae690c.js" defer></script><script src="/JeongShin_Blog/assets/js/2.42bebd90.js" defer></script><script src="/JeongShin_Blog/assets/js/4.dc3b17c2.js" defer></script>
  </body>
</html>
