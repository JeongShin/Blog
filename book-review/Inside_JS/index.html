<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>인사이드 자바스크립트 | JS Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="JeongShin 의 코딩 블로그 👨🏻‍💻">
    <meta name="google-site-verification" content="66JKoxw93huqhAdXO3P0K86NJZne5H-M3302YHcwoWI">
    <link rel="preload" href="/JeongShin_Blog/assets/css/0.styles.59478e82.css" as="style"><link rel="preload" href="/JeongShin_Blog/assets/js/app.9d2f8fc0.js" as="script"><link rel="preload" href="/JeongShin_Blog/assets/js/2.d8f4ba08.js" as="script"><link rel="preload" href="/JeongShin_Blog/assets/js/25.6c5e6b29.js" as="script"><link rel="prefetch" href="/JeongShin_Blog/assets/js/10.20dc9215.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/11.e131a943.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/12.ad3e8e5d.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/13.27a71cb0.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/14.a10b7ca5.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/15.5564ae6b.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/16.3e89b712.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/17.131beb02.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/18.0b2d24ac.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/19.19ee29de.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/20.74be0d62.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/21.f9506ab8.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/22.736ae88b.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/23.f655e1f0.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/24.ccc064a8.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/26.e2b68133.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/27.35b85592.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/28.bd48bbb6.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/29.3f460dc5.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/3.d30578a7.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/30.78027149.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/31.8d9adbb9.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/32.ee91b264.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/4.c53b1d37.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/5.4d629c21.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/6.a88a45fc.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/7.737401d5.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/8.a6850e56.js"><link rel="prefetch" href="/JeongShin_Blog/assets/js/9.f7a58940.js">
    <link rel="stylesheet" href="/JeongShin_Blog/assets/css/0.styles.59478e82.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/JeongShin_Blog/" class="home-link router-link-active"><img src="/JeongShin_Blog/images/logo.jpg" alt="JS Blog" class="logo"> <span class="site-name can-hide">JS Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/JeongShin_Blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/JeongShin_Blog/home/" class="nav-link">
  
</a></div><div class="nav-item"><a href="/JeongShin_Blog/aboutme/" class="nav-link">
  About me
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/JeongShin_Blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/JeongShin_Blog/home/" class="nav-link">
  
</a></div><div class="nav-item"><a href="/JeongShin_Blog/aboutme/" class="nav-link">
  About me
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/JeongShin_Blog/guide/" class="sidebar-link">Guide</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/JeongShin_Blog/TIL/" class="sidebar-heading clickable"><span>Today I Learned</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/JeongShin_Blog/algorithms/" class="sidebar-heading clickable"><span>Algorithms</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/JeongShin_Blog/book-review/" class="sidebar-heading clickable router-link-active open"><span>Book-Review</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/JeongShin_Blog/book-review/OOP_Principle/" class="sidebar-link">자바 객체지향의 원리와 이해</a></li><li><a href="/JeongShin_Blog/book-review/You_Don't_Know_JS/" class="sidebar-link">You Don't Know JS</a></li><li><a href="/JeongShin_Blog/book-review/CoreJS/" class="sidebar-link">코어 자바스크립트</a></li><li><a href="/JeongShin_Blog/book-review/Inside_JS/" aria-current="page" class="active sidebar-link">인사이드 자바스크립트</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JeongShin_Blog/book-review/Inside_JS/#_1장-자바스크립트-기본-개요" class="sidebar-link">1장. 자바스크립트 기본 개요</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/book-review/Inside_JS/#_2장-개발-환경" class="sidebar-link">2장. 개발 환경</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/book-review/Inside_JS/#_3장-자바스크립트-데이터-타입과-연산자" class="sidebar-link">3장. 자바스크립트 데이터 타입과 연산자</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/book-review/Inside_JS/#_4장-함수와-프로토타입-체이닝" class="sidebar-link">4장. 함수와 프로토타입 체이닝</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/book-review/Inside_JS/#_5장-실행-컨텍스트와-클로저" class="sidebar-link">5장. 실행 컨텍스트와 클로저</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/book-review/Inside_JS/#_6장-객체지향-프로그래밍" class="sidebar-link">6장. 객체지향 프로그래밍</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/book-review/Inside_JS/#_7장-함수형-프로그래밍" class="sidebar-link">7장. 함수형 프로그래밍</a></li><li class="sidebar-sub-header"><a href="/JeongShin_Blog/book-review/Inside_JS/#_8-jquery-소스-코드-분석" class="sidebar-link">8. jQuery 소스 코드 분석</a></li></ul></li><li><a href="/JeongShin_Blog/book-review/EasyDB/" class="sidebar-link">가장 쉬운 데이터베이스 설계</a></li><li><a href="/JeongShin_Blog/book-review/Computing_System/" class="sidebar-link">밑바닥부터 만드는 컴퓨팅 시스템</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/JeongShin_Blog/daily/" class="sidebar-heading clickable"><span>Daily</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="인사이드-자바스크립트"><a href="#인사이드-자바스크립트" class="header-anchor">#</a> 인사이드 자바스크립트</h1> <h2 id="_1장-자바스크립트-기본-개요"><a href="#_1장-자바스크립트-기본-개요" class="header-anchor">#</a> 1장. 자바스크립트 기본 개요</h2> <h2 id="_2장-개발-환경"><a href="#_2장-개발-환경" class="header-anchor">#</a> 2장. 개발 환경</h2> <h2 id="_3장-자바스크립트-데이터-타입과-연산자"><a href="#_3장-자바스크립트-데이터-타입과-연산자" class="header-anchor">#</a> 3장. 자바스크립트 데이터 타입과 연산자</h2> <h2 id="_4장-함수와-프로토타입-체이닝"><a href="#_4장-함수와-프로토타입-체이닝" class="header-anchor">#</a> 4장. 함수와 프로토타입 체이닝</h2> <h3 id="함수-3가지-정의-방법"><a href="#함수-3가지-정의-방법" class="header-anchor">#</a> 함수 3가지 정의 방법</h3> <ul><li><code>함수 선언문</code> - function statement</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>내부적으로는 자바스크립트 엔진에 의해 add 변수가 👉 내부적 함수 참조하게 됨</p> <p>function statement 방식은 <strong>반드시 함수명이 정의</strong>되어야 함</p> <ul><li><code>함수 표현식</code> - function expression</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// function expression 의 경우 관습적으로 ; 을 빠지지 않고 붙임</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>함수 변수 add 는 <code>익명 함수</code> - anonymous function 을 참조</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 출력 : 7</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 에러 !</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>함수 표현식에 사용된 함수 이름은 외부에서 접근 불가능.</p> <p>즉, 함수 내부에서 재귀적으로 호출 하거나 디버거 등에서 함수를 구분할때 사용.</p> <ol start="3"><li><code>Funtion() 생성자</code> 함수</li></ol> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'return x + y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 출력 : 7</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="함수-호이스팅"><a href="#함수-호이스팅" class="header-anchor">#</a> 함수 호이스팅</h3> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token function">add</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 출력 : 5</span>
<span class="token keyword">function</span> <span class="token function">add</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 출력 : 7</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>add(2,3) 시점에서는 아직 함수가 정의되지 않았지만 함수가 정상적으로 호출됨.
<code>함수 선언문</code> 형태로 정의한 함수는 <code>호이스팅</code>이 되어 코드 맨 처음부터 유효함.</p> <p><strong>더글럿스 클락포드</strong>는 함수 호이스팅은 함수를 사용하기 전에 반드시 선언해야 한다는 규칙을 무시하므로 코드의 구조를 엉성하게 만들수 있기 때문에 <strong>함수 표현식 사용을 권장</strong>한다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//uncaught type error ! 👉 function expression 방식은 hoisting 되지 않음</span>
<span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>이와 같이 함수 호이스팅이 발생하는 근본적인 원인은 자바스크립트는 <strong>변수 생성과 초기화 작업이 분리되서 진행</strong>되기 때문이다. 이후 내용에서 더 자세하게 다룬다.</p> <h3 id="함수도-객체다-🌟"><a href="#함수도-객체다-🌟" class="header-anchor">#</a> 함수도 객체다 🌟</h3> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

add<span class="token punctuation">.</span>result <span class="token operator">=</span> <span class="token function">add</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// result 프로퍼티 동적 생성</span>
add<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">'OK'</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>add<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 출력 : 5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>add<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 출력 : 'OK'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>add() 함수를 생성하면 함수 객체 <code>[[Code]] 내부 프로퍼티</code>에 저장됨</li></ul> <img src="https://www.plantuml.com/plantuml/svg/9Oqz2i9044RxESNNfR09Y7rw2myGKgox0udkZypC-eDu04jFu1KzWWif7u_76zISM4sHzBpaYnENa4ekVfQI6C9N5cLIxo9Zs_UuBS5cAiSJUuCB0KyQH_WI6DE4t_VpRf5LoRXZWmS9QussYXsrcrLTgJliEthHm3cq_ny0" alt="uml diagram"> <p>JS는 함수도 일반 객체처럼 취급하기 때문에 아래의 동작이 가능</p> <ul><li>리터럴에 의해 생성</li> <li>변수나 배열의 요소, 객체의 프로퍼티 등에 할당 가능</li> <li>함수의 인자로 전달 가능</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Function can be used as the argument'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>함수의 리턴값으로 리턴 가능</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Function can be used as the argument'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>동적으로 프로퍼티 생성 및 할당 가능</li></ul> <p>⭐️ 이와 같은 특징을 <code>일급 객체 First Class</code> 라 부름 가장 중요한건 함수가 <strong>일반 객체처럼 값으로 취급</strong>된다는걸 이해해야한다.</p> <br> <p>add 함수를 좀 더 자세히 들여다보면</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code>ƒ <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
    ⭐️ arguments<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token comment">// 👉 함수를 호출할때 전달된 인자 값, 함수를 호출할때 함수 내부로 전달됨</span>
    ⭐️ caller<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token comment">// 👉자신을 호출한 함수, 현재 add() 함수를 호출하지 않았기 때문에 null</span>
    length<span class="token operator">:</span> <span class="token number">2</span>
    name<span class="token operator">:</span> <span class="token string">&quot;add&quot;</span> <span class="token comment">// 👉 함수 이름</span>
    ⭐️ prototype<span class="token operator">:</span> <span class="token punctuation">{</span>constructor<span class="token operator">:</span> ƒ<span class="token punctuation">}</span>
    ⭐️ __proto__<span class="token operator">:</span> <span class="token function">ƒ</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">/* 👉 모든 객체는 자신의 프로토타입을 가리키는 [[Prototype]] 내부 프로퍼티를 가짐,
    여기서는 Function.prototype 객체 */</span>
        apply<span class="token operator">:</span> ƒ <span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        arguments<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
        bind<span class="token operator">:</span> ƒ <span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        call<span class="token operator">:</span> ƒ <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        caller<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token comment">// 👉 자신을 호출한 함수</span>
        constructor<span class="token operator">:</span> ƒ <span class="token function">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        length<span class="token operator">:</span> <span class="token number">0</span>
        name<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        toString<span class="token operator">:</span> ƒ <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">Symbol</span><span class="token punctuation">(</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">)</span><span class="token operator">:</span> ƒ <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">get</span> arguments<span class="token operator">:</span> <span class="token function">ƒ</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">set</span> arguments<span class="token operator">:</span> <span class="token function">ƒ</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">get</span> caller<span class="token operator">:</span> <span class="token function">ƒ</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">set</span> caller<span class="token operator">:</span> <span class="token function">ƒ</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
        __proto__<span class="token operator">:</span> Object
        <span class="token punctuation">[</span><span class="token punctuation">[</span>FunctionLocation<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span>Scopes<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> Scopes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token punctuation">[</span>FunctionLocation<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">VM1691</span><span class="token operator">:</span><span class="token number">1</span>
    <span class="token punctuation">[</span><span class="token punctuation">[</span>Scopes<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> Scopes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>모든 함수들은 <code>Function.prototype 객체</code> 를 부모 객체로 가진다. 그리고 Function Prototype 객체는 모든 객체의 조상인 <code>Object.prototype 객체</code> 를 부모로 가진다.</p> <img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIhEpimhI2nAp5N8pS_BJyueoizDLIXABKijAaxbya_AIaqkqIieoY_9BwaiI5MmgT7LLN0hpKikoSpFGuXpOGgXAKq3CWo9KsP4M5b5HGMNGsfU2j030000" alt="uml diagram"> <p>Function.prototype 객체가 가지는 내장 프로퍼티 &amp; 메서드들은 다음과 같은 것들이 있다.</p> <ul><li>constructer 프로퍼티</li> <li>toString() 메서드</li> <li><strong>apply</strong> (thisArg, argArray) 메서드</li> <li><strong>call</strong> (thisArg, [, arg1 [, arg2]]) 메서드</li> <li>bind (thisArg,[, arg1[, arg2]]) 메서드</li></ul> <p><strong>length 프로퍼티</strong></p> <p>함수가 정상적으로 실행될 때 기대되는 인자의 개수를 나타낸다.</p> <h3 id="prototype-프로퍼티-vs-prototype-프로퍼티"><a href="#prototype-프로퍼티-vs-prototype-프로퍼티" class="header-anchor">#</a> prototype 프로퍼티 vs [[Prototype]] 프로퍼티</h3> <p>두 프로퍼티 모두 프로토타입 객체를 가리킨다.</p> <p><code>[[Prototype]]</code> 👉 자신의 부모 역할을 하는 프토토타입 객체를 가르킴</p> <p><code>prototype</code> 👉 이 함수가 생성자로 사용될 때 이 함수를 통해 생성된 객체의 부모역할을 하는 프토토타입 객체</p> <img src="https://www.plantuml.com/plantuml/svg/ZO_12i9034Jl-OhyGA5u50_z4rdJIBTsaoMRLGhzU8kb5Znv6nupmqnNF9ZND45vHCd1GiAaeZIO9aRZ9rjXA1GcnbFRuYlsFe3UHYR7UnNog0Axm3DcKrUVCyFksaYU-Re1-0LhYbIAMoLNWwFjiZJD7_6FxRkbO-dNGsy0" alt="uml diagram"> <p>자바스크립트에서는 함수를 생성할 때, 함수 <strong>객체 자신</strong>과 연결된 <strong>프로토 타입 객체</strong> 두 객체를 동시에 생성하며 위의 그림과 같이 <strong>prototpye, constructor</strong> 라는 프로퍼티로 <strong>서로 참조</strong>하게 된다.</p> <p>⭐️ 즉, 함수 객체와 프로토 타입 객체는 서로 밀접하게 연결되어 있다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myFunction</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>myFunction<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token comment">/* 프로토 타입 객체 출력 결과
Object
constructor: ƒ myFunction() 👉 생성자 함수
__proto__: Object 👉 모든 자바스크립트 객체가 가지는 부모 역할 프로퍼티
*/</span>

console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>myFunction<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span>
<span class="token comment">/* constructor 와 매핑되어 있는 함수, 즉, myFunction() 함수 출력 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><code>Callback Functions</code></p> <p>어떤 이벤트가 발생했거나 특정 시점을 도달했을때 시스템에서 호출되는 함수</p> <p><code>Immediate Functions</code></p> <p>최초 한 번의 실행만을 필요로하는 초기화 코드 부분에 사용가능</p> <p>또한 전역 네임스페이스를 더럽히지 않음으로 이후 다른 자바스크립트 라이브러리들이 동시에 로드가 되더라도 라이브러리 간 뼌수 이름 충돌 같은 문제를 방지할 수 있다.</p> <p><code>Inner Functions</code></p> <p>클로저를 생성하거나 부모 함수 코드에서 외부에서의 접근을 막고 독립적인 헬퍼 함수를 구현하는 용도로 사용</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">parent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">200</span>
    <span class="token keyword">function</span> <span class="token function">child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">300</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 내부 함수 정의와 내부 함수 호출이 모두 스코프 내에 있다 GOOD ⭕️</span>
<span class="token punctuation">}</span>
<span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 함수 내부에 정의는 되어 있는 함수를 외부에서 접근이 불가능 하다 BAD ❌</span>

<span class="token comment">/* 출력 결과
100
300
Uncaught ReferenceError : child is not defined
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>내부 함수 child 에서는 자신을 둘러싼 외부 함수의 변수에 접근이 가능하다 이를 <code>스코프 체이닝</code> 이라 부른다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">parent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">var</span> <span class="token function-variable function">child</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// child() 함수 반환</span>
    <span class="token keyword">return</span> child
<span class="token punctuation">}</span>
<span class="token keyword">var</span> inner <span class="token operator">=</span> <span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">/* 출력 결과 : 100 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIhEpimhI2nAp5N8pS_BJyueoizDLIXABKijAaxb0gegILK0IgVcbRoTkk9Dnmo5QgYWaiQRkLjVhshLLF3CoqijKd0hpKikoSpFKr98B5P8WobALB1IC3Gm00kM6S94apCoSr8qD1MWHhxUt02a86gCkDA0MfBpyuhpSrBrSlBJDH8rkMfX6j_CtF5wMuD29jX6P6t6N5nbnWgwTa2Rqq0KqAuo8mZV8JKl1UXH0000" alt="uml diagram"> <p>위와 같이 내부 함수를 참조하는 child 변수를 리턴 값으로 반환하면 <strong>inner 변수가 child() 내부 함수를 참조</strong>하게 된다.</p> <p>따라서 inner 변수로 내부 함수를 호출하게 되면 <strong>스코프 체이닝</strong>으로 부모 함수에 a 변수가 정의되어 있는지 확인하고 a 값을 출력한다.</p> <p>이와 같이 실행이 끝난 parent() 와 같은 부모 함수 스코프의 변수를 참조하는 inner 함수를 <code>클로저</code> 라고 한다.</p> <p>예제) 자신을 제정의 하는 함수</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">self</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
self <span class="token operator">=</span> <span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'a'</span>
<span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'b'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>위의 코드는 처음 정의된 self 함수가 실행되고 내부 익명 함수를 반환하여 두 번째로 실행하였을때 내부 함수를 실행하게 된다.</p> <p>이 코드를 통해 자바스크립트의 언어적 유연성을 볼 수 있다.</p> <h3 id="함수-호출과-this-⭐️⭐️"><a href="#함수-호출과-this-⭐️⭐️" class="header-anchor">#</a> 함수 호출과 this ⭐️⭐️</h3> <p><code>arguments 객체</code></p> <p>JS에서는 함수 인자를 맞춰주지 않아도 선언된 인자보다 적으면 undefined 를 할당하고, 초과될시 무시 하는데 런타임시에 인자의 개수에 따라 다르게 동작해야한다면 <strong>arguments 객체를 사용</strong>해야 한다.</p> <p>arguments 객체는 다음과 같이 세 부분으로 구성되어 있다 (<strong>proto</strong> 제외)</p> <div class="language- extra-class"><pre><code>함수를 호출할 때 넘겨진 인자 (유사 배열)
length 포로퍼티 👉 인자 개수
callee 프로퍼티 👉 현재 실핼 중인 함수의 참조 값
</code></pre></div><p>이를 이용하여 아래와 같은 코딩을 할 수 있다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        result <span class="token operator">+=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 6</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 45</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>이때 유의할 점은 이 객체는 실제 배열이 아닌 <code>유사 배열 객체</code> 이다. 즉, 배열과 같이 length 를 가지고 있지만 배열에 사용하는 메서드를 맘대로 사용하다간 큰일난다. 이와 관련해서는 이후에 <strong>call 과 apply 메서드를 이용한 명시적인 this 바인딩</strong> 에서 다룬다.</p> <h3 id="객체의-메서드-호출할-때-this-바인딩"><a href="#객체의-메서드-호출할-때-this-바인딩" class="header-anchor">#</a> 객체의 메서드 호출할 때 this 바인딩</h3> <p>객체의 프로퍼티가 함수일 경우, 이 함수를 메서드라고 부른다. 메서드를 호출할 때, <strong>메서드 내부에서 사용된 this 는 해당 메서드를 호출한 객체로 바인딩</strong> 된다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> myObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    name <span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">sayName</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> otherObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    name <span class="token operator">:</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span>

otherObject<span class="token punctuation">.</span>sayName <span class="token operator">=</span> myObject<span class="token punctuation">.</span>sayName

myObject<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// foo</span>
otherObject<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// bar</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><br> <img src="https://www.plantuml.com/plantuml/svg/PP0zRW8n48NxESM8Pg600wm4uWHmXCWiiwo3xObiyoU45AM4beA2DgbIK214aHDbuGuOWHRGTlFqtllqD6tdXVKZhS0DfVaGLcZKR3Z9B6j2IsEoZa0enPCtBQVI302uzqw9Hpthteuv6172JOnwmaRWnAnprn4iYZZxZ6ofaJAN6s6K9woa8vDuoQPQgw1mc4AACIPi72jgA1vKVIPTuqggGV3gzTPZKroS_xjFF6-EfyFsjDhYjP8lruMRV_zXIEG_l-Ul_Htol3H-KMNEi_lWG9jCFtpr0W00" alt="uml diagram"> <p>위와 같이 sayName() 메서드에 사용된 <strong>this는 자신을 호출한 객체에 바인딩</strong> 되는걸 볼 수 있다.</p> <p>자바스크립트에서 함수를 호출하면, 해당 함수 내부 코드에서 사용된 this는 <code>전역 객체</code>에 바인딩 된다.</p> <h3 id="전역객체"><a href="#전역객체" class="header-anchor">#</a> 전역객체</h3> <p>브라우저 환경에서 전역객체는 window 객체가 된다. Node.js에서는 global 객체가 된다.</p> <p>자바스크립트의 모든 전역 변수는 전역 객체의 프로퍼티가 된다. 아래의 예제를 보자</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token string">'this is test'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>test<span class="token punctuation">)</span> <span class="token comment">// 전역 객체의 프로퍼티가 됨</span>

<span class="token keyword">var</span> <span class="token function-variable function">sayFoo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>test<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">sayFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>예제에서 'this is test' 전역 객체에서 sayFoo를 호출하였기 때문에 this는 전역 객체로 바인딩 된다. 이때 this 바인딩 특성은 <strong>내부 함수를 호출했을 경우</strong>
에도 그대로 적용된다.</p> <h3 id="예제-1-내부-함수가-전역-객체에-바인딩"><a href="#예제-1-내부-함수가-전역-객체에-바인딩" class="header-anchor">#</a> 예제 1 : 내부 함수가 전역 객체에 바인딩</h3> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">var</span> myObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    value <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token function-variable function">func1</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'func1 called value is '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token function-variable function">func2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'func2 called value is '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
            <span class="token function-variable function">func3</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'func3 called value is '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
myObject<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">/* 출력 결과
func1 called value is 2
func2 called value is 101
func3 called value is 102
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIhEpimhI2nAp5N8pS_BJyueoizDLIXABKijAaxbIip9oI_FpQp8p4ldoa_AIaqkKSYjz8SmghdA4dDAKnLi5OouqahpaWs1h6YjMAvQBfZIyioybFno98M61WOWQQ3T9QaAIc1D6feAhrTEUTCov_NaEKeAYSKAQSZIHY3ffYsljpMydRhYJSSCY0f3P2N6M9K0dQIWgsk7SAsLGab6PZ5NcY5O6EeocA0H5a4kXzIy56000G00" alt="uml diagram"> <p>예제 1에서는 내부 함수 호출 패턴이 정의되어 있지 않기 때문에 내부 함수가 호출 될 때, <strong>this 는 전역 객체 window에 바인딩</strong> 된다.</p> <p>만약 내부 함수에서 myObject 를 접근하려면 <strong>부모 함수의 this</strong> 를 내부 함수가 접근 가능한 <strong>다른 변수에 저장</strong>하여 내부 함수가 전역 객체를 참조하는걸 극복할 수 있다. 예제 2를 보자.</p> <h3 id="예제-2-that-을-이용한-this-바인딩"><a href="#예제-2-that-을-이용한-this-바인딩" class="header-anchor">#</a> 예제 2 : that 을 이용한 this 바인딩</h3> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">var</span> myObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    value <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token function-variable function">func1</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
        <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
        <span class="token comment">/* ⭐️ 스코프 체이닝으로 인해 내부 함수는 외부 변수 that 에 접근 할 수 있다
        that 은 myObject this를 참조한다.
        즉, 이후 that으로 myObject value를 접근 가능해진다. */</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'func1 called value is '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token function-variable function">func2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            that<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'func2 called value is '</span> <span class="token operator">+</span> that<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
            <span class="token function-variable function">func3</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                that<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'func3 called value is '</span> <span class="token operator">+</span> that<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
myObject<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">/* 출력 결과
func1 called value is 2
func2 called value is 3
func3 called value is 4
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIhEpimhI2nAp5N8pS_BJyueoizDLIXABKijAaxbIip9oI_FpQp8p4ldoa_AIaqkKSYjz8SmghdA4dDAKnLi5GovqahpaWs1h6YjMAvQBg3P9QaAIc113Ks5rokdl6cPytho72M5n6A5D6Hf8v1qqvRNsnhUJbtnfcC6H8KXiX9Zh4gCkD8KT7Nj4AwnKYZ9o2pcIZC42wU1-OabN6b6g7o7rBmKeAy1" alt="uml diagram"> <p>자바스크립트는 이와 같은 this 바인딩의 한계를 극복하기 위해 this 바인딩을 명시적으로 할 수 있도록 <code>call</code> 과 <code>apply</code> 메서드를 제공한다.</p> <p>jQuery, underscore.js 등의 라이브러리는 <code>bind</code> 라는 메서드를 통해 사용자가 <strong>원하는 객체를 this에 바인딩</strong>하도록 돕는다.</p> <h3 id="생성자-함수-동작-방식"><a href="#생성자-함수-동작-방식" class="header-anchor">#</a> 생성자 함수 동작 방식</h3> <p>JS에서는 기존 함수에 new 연산자를 붙여서 호출하면 해당 함수는 생성자 함수로 동작하게 된다. 즉, new를 잘못사용하게 되면 원하지 않는 생성자를 실행할 수도 있다.</p> <p>대부분의 자바스크립트 스타일 가이드에서는 생성자 함수의 첫 이름을 대문자로 쓰길 권하고 있다. 생성자 함수에서 this는 이전에 다루었던 this 바인딩과는 다르게 동작한다.</p> <div class="custom-block tip"><p class="custom-block-title">new 연산자로 함수 호출시 동작 방식</p> <ol><li><p>빈 객체 생성 및 this 바인딩</p> <ul><li>가장 먼저 빈 객체가 생성된다</li> <li>이 객체는 this로 바인딩 된다</li> <li>따라서 생성자 함수 코드 내부에서 this 는 이 빈 객체를 가리킨다</li> <li>여기서 엄밀히 따지면 빈 객체는 아니다 (아래 내용 참고)</li></ul></li></ol> <p><code>JS 객체 생성 규칙</code>
👉 JS에서 모든 객체는 자신의 부모인 프로토 타입 객체와 연결되어 있으며
부모의 프로퍼티나 메서드를 사용할 수 있는데 생성자 함수가 생성한 객체는
자신을 생성한 <strong>생성자 함수의 prototype 프로퍼티가 가리키는 객체</strong>를
<strong>자신의 프로토 타입 객체로 설정</strong>한다</p> <ol start="2"><li><p>this를 통한 프로퍼티 생성</p> <p>이후에 함수 코드 내부에서 this를 사용하여 앞에서 생성된 <strong>빈 객체에 동적으로 프로퍼티나 메서드를 생성</strong>할 수 있게 된다</p></li></ol> <ol start="3"><li><p>생성된 객체 리턴</p> <p>가장 일반적인 경우 특별한 리턴문이 없는 경우 <strong>this 로 바인딩 된 새로 생성한 객체가 리턴</strong>된다. 이는 명시적으로 this를 리턴한 값과 동일하다.
this 가 아닌 객체를 리턴하는건 이후에 다루도록 한다.</p></li></ol></div> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 생성자 함수는 관례적으로 첫 글자는 대문자 이름 사용</span>
    <span class="token comment">/* ⭐️ 아래 코드가 실행되기 전에 빈 객체를 생성 후 Person() 의
    prototype 프로퍼티가 가리키는 객체, Person.prototype, 를 [[Prototype]] 링크로 연결하여
    자신의 프로토타입으로 설정 후 this로 바인딩 */</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token comment">/* this가 가리키는 빈 객체에 동적으로 name 프로퍼티 생성 */</span>
    <span class="token comment">/* 특별히 리턴값이 없는 경우 this로 바인딩된 이 객체가 리턴됨 */</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="리터럴-vs-생성자-객체-생성"><a href="#리터럴-vs-생성자-객체-생성" class="header-anchor">#</a> 리터럴 vs 생성자 객체 생성</h3> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 리터럴 방식 : 1 번만 생성 가능</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    name <span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
    age <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
    gender <span class="token operator">:</span> <span class="token string">'man'</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span>

<span class="token comment">/* 출력 결과 */</span>
Object
age<span class="token operator">:</span> <span class="token number">35</span>
gender<span class="token operator">:</span> <span class="token string">&quot;man&quot;</span>
name<span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
__proto__<span class="token operator">:</span> Object

<span class="token comment">// 생성자 함수 : 여러번 생성 가능</span>
<span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> position</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender
<span class="token punctuation">}</span>

<span class="token comment">// Person 생성자 객체 생성</span>
<span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span> <span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token string">'woman'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span>

<span class="token comment">/* 출력 결과 */</span>
Person
age<span class="token operator">:</span> <span class="token number">33</span>
gender<span class="token operator">:</span> <span class="token string">&quot;woman&quot;</span>
name<span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span>
__proto__<span class="token operator">:</span> Object

<span class="token keyword">var</span> baz <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span> <span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'woman'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>baz<span class="token punctuation">)</span>

<span class="token comment">/* 출력 결과 */</span>
Person
age<span class="token operator">:</span> <span class="token number">25</span>
gender<span class="token operator">:</span> <span class="token string">&quot;woman&quot;</span>
name<span class="token operator">:</span> <span class="token string">&quot;baz&quot;</span>
__proto__<span class="token operator">:</span> Object
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>리터럴 방식과 생성자 방식의 차이는 프로토타입 객체 (<code>__proto__</code> 프로퍼티) 에 있다. 객체 리터럴의 경우 <code>Object.prototype</code> 을 생성자의 경우 <code>Person.prototype</code> 을 프로퍼티로 가진다.</p> <p>이는 위에서 설명한 <code>JS 객체 생성 규칙</code> 에 따라 리터럴에선 객체 생성자가 Object() 이고 생성자에선 생성자가 Person() 함수이기 때문이다.</p> <div class="custom-block tip"><p class="custom-block-title">생성자 함수를 new 없이 호출하면 어떤 사악한 일이 일어날까? 👿</p> <p>new 를 이용한 생성자 함수에서 this는 빈 객체에 바인딩 된다고 위에서 다루었다.
하지만 new 키워드 없이 생성자 함수를 호출하게 되면 빈 객체가 아닌 글로벌 객체에 this가 바인딩 되어
글로벌 객체에 프로퍼티를 생성한다. 즉, 끔찍한 일이 발생한다. 주의하자 !</p></div> <h4 id="강제-인스턴스-생성-코드-패턴"><a href="#강제-인스턴스-생성-코드-패턴" class="header-anchor">#</a> 강제 인스턴스 생성 코드 패턴</h4> <p>다음은 더글러스 크락포드와 JS 전문가들이 제안하는 new 키워드 없이 객체를 생성을 방지하기 위한 코드 패턴이다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">A</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">A</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// or if (!(this instanceof arguments.callee))</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> arg <span class="token operator">?</span> arg <span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment">// a.value : 100</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// b.value : 10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>global<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>if (!(this instanceof arguments.callee)) 코드에서 호출한 함수가 new 키워드가 사용되어 빈 객체 생성 후 이 객체에 <strong>this가 바인딩 되었는지에 대한 여부를 검사</strong>한다.</p> <p>위의 코드 패턴을 통하여 new 키워드를 사용하지 않아도 전역 객체가 아닌 새로운 인스턴스를 생성하여 리턴하게 된다. 이는 대부분의 JS 라이브러리에 사용되는 코드 패턴이다.</p> <h3 id="call-과-apply-메서드를-이용한-명시적-this-바인딩"><a href="#call-과-apply-메서드를-이용한-명시적-this-바인딩" class="header-anchor">#</a> call 과 apply 메서드를 이용한 명시적 this 바인딩</h3> <p>지금까지는 this 바인딩이 JS에 의하여 자동으로 바인딩 되었지만 이번 예제에선 함수 객체 기본 프로퍼티인 apply() 와 call() 을 이용하여 명시적으로 this를 바인딩 한다.
모든 함수는</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span><span class="token punctuation">.</span><span class="token function">appy</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">,</span> argArray<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>와 같이 호출이 가능하다. apply() 메서드를 호출하는 주체는 함수이고 apply() 메서드도 this를 특정 객체에 바인딩할 뿐 <strong>본질은 함수 호출</strong> 이다.</p> <p>첫번째 인자 <code>thisArg</code> 는 호출한 함수 내부에서 사용한 <strong>this에 바인딩할 객체</strong>를 가리킨다. 즉, 첫번째 인자가 this로 명시적이게 바인딩 된다.</p> <p>두번째 인자 <code>argArray</code> 는 호출할 때 넘길 인자들의 배열을 가리킨다.</p> <p>즉, apply() 메서드는 (명시적 this, 인자 배열) 을 인자로 함수를 호출하는 셈이다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span> <span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender
<span class="token punctuation">}</span>
<span class="token comment">// 리터럴로 생성한 빈 객체</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// foo 를 this 로 바인딩</span>
<span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'man'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>위와 같이 원하는 값을 명시적으로 바인딩하여 특정 함수나 메서드에서 접근이 가능하다.</p> <p>가장 대표적인 예로 <code>유사 배열 객체</code>에서 사용하는 배열 메서드가 있다. <code>arguments 객체</code>는 실제 배열이 아니기 때문에 pop(), shift() 같은 배열의 메서드를 사용할 수 없다. 하지만 apply() 를 사용하면 가능하다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
    <span class="token comment">// arguments.shift() 👉 Error 🤯</span>
    <span class="token comment">// arguments 객체를 배열로 변환</span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
    <span class="token comment">// 또는 ES6 Array.from(arguments) 도 가능</span>
    console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
    <span class="token comment">// __proto__ 프로퍼티가 Array로 바뀐걸 확인 가능</span>
<span class="token punctuation">}</span>
<span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>JS 함수 리턴 규칙</p> <ul><li>규칙 1 일반 함수나 메서드는 리던값을 지정하지 않을 경우, undefined 값이 리턴된다.</li> <li>규칙 2 생성자 함수에서 리턴값을 지정하지 않을 경우 <strong>생성된 객체가 리턴</strong>된다.</li></ul> <h3 id="프토로타입-체이닝-👉-일단-skip"><a href="#프토로타입-체이닝-👉-일단-skip" class="header-anchor">#</a> 프토로타입 체이닝 👉 일단 Skip !</h3> <h2 id="_5장-실행-컨텍스트와-클로저"><a href="#_5장-실행-컨텍스트와-클로저" class="header-anchor">#</a> 5장. 실행 컨텍스트와 클로저</h2> <h3 id="실행-컨텍스트"><a href="#실행-컨텍스트" class="header-anchor">#</a> 실행 컨텍스트</h3> <p>실행 컨텍스트란 C나 다른 언어에서의 콜 스택에 들어가는 실행 정보 하나와 비슷하다. ECMAScript에서는 실행 컨텍스트를 <strong>실행 가능한 코드를 형상화하고 구분하는 추상적인 개념</strong>이라 기술한다. 즉, <strong>실행 가능한 자바스크립트 코드 블록이 실행되는 환경</strong> 이라 할 수 있다. 실행 컨텍스트가 형성되는 경우는</p> <ol><li>전역 코드</li> <li>eval() 함수로 실행되는 코드</li> <li>함수 안의 코드를 실행할 경우 👉 대부분의 경우</li></ol> <p>ECMAScript 에서는 실행 컨텍스트 생성을 다음과 같이 설명 한다</p> <div class="language- extra-class"><pre><code>현재 실행되는 컨텍스트에서 이 컨텍스트와 관련 없는 실행 코드가 실행되면,
새로운 컨텍스트가 생성되어 스택에 들어가고 제어권이 그 컨텍스트로 이동한다

실행 컨텍스트를 이해하면 다음 두 가지 개념을 이해할 수 있다.
👉 활성 객체와 변수 객체
⭐️ 스코프 체인

샐행 컨텍스트 생성 과정
1. 활성 객체 생성
    실행에 필요한 정보를 담을 객체 생성하는데 이를 활성 객체라 부름
2. arguments 객체 생성
3. 스코프 정보 생성
    실행 컨텍스트 안에서 연결 리스트와 유사한 형식으로 스코프 정보 생성
    [[scope]] 프로퍼티로 참조됨
4. 변수 생성
    지역 변수 생성
5. this 바인딩
6. 코드 실행
    변수의 초기화 및 연산, 다른 함수 실행 등이 이루어 진다.
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Node.js에서의 전역 변수</p> <p>브라우저에서는 <strong>최상위 코드가 전역 코드</strong>이다. 따라서</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span>
b <span class="token operator">=</span> <span class="token number">15</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>a<span class="token punctuation">)</span> <span class="token comment">// 10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token comment">// 15</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>var a 로 정의한 변수가 전역 객체인 window 의 프로퍼티로 들어가기 때문에 위의 코드가 잘 실행된다.
하지만 Node.js 에서는</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span>
b <span class="token operator">=</span> <span class="token number">15</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>global<span class="token punctuation">.</span>a<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>global<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token comment">// 15</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>최상위 코드가 전역 코드가 아니다. 따라서 var a 가 전역 객체에 들어가지 않는다. 이는 Node.js 에서는 하나의 js 파일이 모듈로 작동하기 때문에 모듈 내에서 최상위에 변수를 선언해도 그 <strong>모듈의 지역 변수</strong>가 된다. var 을 사용하지 않을 경우 전역 객체인 global 에 들어가기 때문에 주의하자</p></div> <p>스코프 체인을 정리해보면</p> <p>👉 각 함수 객체는 [[scope]] 프로퍼티로 현재 컨텍스트의 스코프 체인을 참조한다</p> <p>👉 새로운 실행 컨텍스트가 실행되면 (함수호출) 현재 실행중인 함수 객체의 [[scope]] 프로퍼티를 복사하고,
새롭게 생성된 변수 객체를 해당 체인의 제일 앞에 추가한다.</p> <p>👉 다른 언어와 다르게 JS에서는 <strong>오직 함수만이 스코프 유효 범위의 한 단위</strong>가 된다. (C 코드의 경우 if, for 문의 {} 단위가 있음)</p> <p>⭐️ 스코프 체인 = 현재 실행 컨텍스트의 변수 객체 + 상위 컨텍스트의 스코프 체인</p> <p>⭐️ 즉, 각각의 함수는 [[scope]] 프로퍼티로 <strong>자신이 생성된</strong> 실행 컨택스트의 스코프 체인을 참조한다. 함수가 실행되는 순간 실행 컨텍스트가 만들어지고, 이 실행 컨텍스트는 <strong>실행된 함수의 [[scope]] 프로퍼티를 기반</strong>으로 새로운 스코프 체인을 만든다.</p> <h4 id="스코프-체인-예제-1"><a href="#스코프-체인-예제-1" class="header-anchor">#</a> 스코프 체인 예제 1</h4> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token string">'value1'</span>
<span class="token keyword">function</span> <span class="token function">printFunc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token string">'value2'</span>
    <span class="token keyword">function</span> <span class="token function">printValue</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">printValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 출력 : value1</span>
<span class="token punctuation">}</span>
<span class="token function">printFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><img src="https://www.plantuml.com/plantuml/svg/bPAzIiH04CVxUOeX_K6o-H0iv2eVmKQkM78B2Mu-o2Qn4C52GKz4AxKHBAwmEH2rEF1jhjGDleBhxXbDF8HZYztvp_vdVpFiK9IqAAk4WmWfPxXXsxWVZyi8n5wSvhIW2IPPceLHaIKC2rQpGZ1GhfAXPLj81N87beAyFvOtCta-RQxFvEj3St8X9zDcCiU3RyVxyv4ylNrxl9DFBzfSGusRM5DUCRLR-k1OMioBE2stgpJKKHd5GXzsrH9XbZCSuGWEbJOOR7r1S4Tb3O9v07gSP1ctXTSZ9L2JFwp4CggkkQDJYzdLn_pIo8QQhC8cXfi09trkRd8EEB_7W0O9kytzFBnUDoxKRWlehW3ipiu3xlKnbKstuBM3Tinb7xZ_3xcgf7r-woF65m0FkhFi6NrZ3026B1shR_i9" alt="uml diagram"> <p>위의 다이어그램을 보자 ⭐️ 부분에서 printValue 의 <strong>함수 객체가 생성될 때</strong> 실행 컨텍스트는 printFunc 이다. 따라서 printFunc의 <strong>스코프를 복사</strong>하여 자신의 새로운 변수 객체가 추가되었다.</p> <h4 id="스코프-체인-예제-2"><a href="#스코프-체인-예제-2" class="header-anchor">#</a> 스코프 체인 예제 2</h4> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token string">'value1'</span>
<span class="token keyword">function</span> <span class="token function">printValue</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> value
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">printFunc</span> <span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token string">'value2'</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 출력 : value1</span>
<span class="token punctuation">}</span>
<span class="token function">printFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><img src="https://www.plantuml.com/plantuml/svg/bP8_IyGm6CRtzrEyT3zeqnR1GMxo8xZ83QKNQJ7zGzB6GGG71JqHdTH5SBZ1vK3KuS1luwWfVWLZSlPilUN8aEH9dkJtlCbGL16lweo1Y2D6SSDryI0TLmc8_JGl8nvbc1Lv4IUyo2XoAYaN5BIhekYu3aO2cGSBGJsSgDkPkfWsD-VgxR4vlLIJQJEPu-6lu_FbM9tTVJpTg-TNOvOWSHDbn6ggUySCFCU89K_pQhlEu-Lin-nxdrr_pQ_0o5MI2ZFOrKt4HKbnX2CuqjfWiFN3nZozQidilT339ujvUzzw0GX8yYy2SQowP_192qfMaHABIe2HFYgpQnvuVmk2bWAxUPOLMY-03z9l0VqLWDro1S22FgQscGX1MrlFRWw1XTt7wwBheumn11ZIVAm_uZS0" alt="uml diagram"> <p>위의 다이어그램을 보자 ⭐️ 부분에서 printValue 의 함수 객체가 생성될 때 실행 컨텍스트는 첫 번째 예제와 달리 <strong>전역 실행 컨텍스트</strong> 이다. 따라서 스코프가 전역 실행 스코프의 프로퍼티만 복사한다.</p> <p><code>식별자 인식</code> 은 스코프 체인으로 부터 식별자를 찾는데 스코프 제일 첫번째 변수 객체부터 (지역 변수, 공식 인자, 내부 함수) 에서 전역 객체까지 순서대로 인식한다. 단 this 는 식별자가 아닌 키워드로 분류 되므로, 스코프 체인 참조 없이 접근 할 수 있다.</p> <h4 id="이쯤-다시보는-호이스팅"><a href="#이쯤-다시보는-호이스팅" class="header-anchor">#</a> 이쯤 다시보는 호이스팅</h4> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* 전역 실행 컨텍스트가 실행 되면 변수 foo, 함수 객체 bar,
 변수 x를 차례로 생성된다. foo, x 에는 undefined 가 할당된다.
 이 작업은 코드 실행 전에 이루어진다 */</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// TypeError 🙅🏻‍♂️</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 출력 : undefined</span>
<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">bar</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>이쯤 되니까 호이스팅이 왜 저렇게 작동하는지 더 이해가 잘 된다 😇</p> <h3 id="클로저"><a href="#클로저" class="header-anchor">#</a> 클로저</h3> <p>일단 이 책에서의 정의를 먼저 보고 시작하자. 클로저는 <strong>이미 생명 주기가 끝난 외부 함수의 변수를 참조하는 함수</strong>를 클로저 라고 한다.</p> <p>아래 예제를 보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">outerFunc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token keyword">var</span> <span class="token function-variable function">innerFunc</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> innerFunc
<span class="token punctuation">}</span>
<span class="token keyword">var</span> inner <span class="token operator">=</span> <span class="token function">outerFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 10</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>예제에서 함수별 실행 컨텍스트 스코프 보면 아래와 같이 된다.</p> <ul><li><p>전역 실행 컨텍스트 [[scope]] 👉 전역 객체</p></li> <li><p>outerFunc [[scope]] 👉 전역 객체 👉 outerFunc 변수 객체</p></li> <li><p>innerFunc [[scope]] 👉 전역 객체 👉 outerFunc 변수 객체 👉 innerFunc 변수 객체</p></li></ul> <p>하지만 9행을 보면 innerFunc 실행 컨텍스트가 outerFunc 실행 컨텍스트가 사라진 이후에 생성된다.</p> <p>하지만 출력 결과를 보면 알 수 있듯이 outerFunc 변수 객체는 여전히 남아 있고 innerFunc의 스코프 체인으로 참조되고 있다. 이것이 바로 <code>클로저</code>이다.</p> <p>위에서 다루엇 듯이 JS에서 함수는 <code>일급 객체</code>로 취급된다. 즉, return 값으로 함수를 반환 할 수 있다는 뜻인데, 외부 함수가 반환 되더라도 (생명주기가 끝나더라도) <strong>변수 객체는 내부 함수의 스코프 체인에 그대로 남아 접근</strong> 할 수 있다.</p> <p>따라서 예제의 outerFunc 에서 선언된 x를 참조하는 innerFunc가 클로저가 된다. 클로저로 참조되는 x 같은 외부 함수의 지역변수를 <code>자유변수 free variable</code> 이라 한다.</p> <p>아래는 흔한 클로저를 구현하는 코드 패턴이다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">outerFunc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/* some codes with arguments &amp; x */</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> new_func <span class="token operator">=</span> <span class="token function">outerFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">new_func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>대부분의 클로저를 활용하는 코드는 이와 같은 코드 패턴을 유지한다. 이를 바탕으로 JS를 이용한 <code>함수형 프로그래밍</code>이 가능하다.</p> <div class="custom-block tip"><p class="custom-block-title">함수형 언어 functional language</p> <p>함수를 일급 객체로 취급하는 언어를 함수형 언어라 한다.
이는 자바스크립트 뿐만 아니라 여러가지 함수형 언어도 해당되지만 클로저의 개념을 꼭 이해해야 한다.</p></div> <h3 id="클로저-활용"><a href="#클로저-활용" class="header-anchor">#</a> 클로저 활용</h3> <p>클로저는 내부 함수에서 접근하는 변수 대부분이 스코프 체인의 첫 번째 객체가 아닌 그 이후 객체에 존재한다.
따라서 변수를 스코프 체인 끝 쪽에 까지 자주 접근하게 되므로 <strong>성능 저하와 메모리 부담 이슈</strong>가 있다.
따라서 클로저는 무차별적으로 사용되지 말고 영리하게 사용되어야 한다.</p> <p>7장 함수형 프로그래밍에서 소개되는 대부분의 내용이 클로저를 사용하기 때문에 꼭 이해하고 넘어가자.
좋은 자바스크립트 프로그래머가 되려먼 많은 개발 경험을 쌓는 것이 가장 중요하다.</p> <h4 id="객체의-메서드-연결하기"><a href="#객체의-메서드-연결하기" class="header-anchor">#</a> 객체의 메서드 연결하기</h4> <p><code>TODO</code> 아직 이해를 못했음</p> <h4 id="함수의-캡슐화"><a href="#함수의-캡슐화" class="header-anchor">#</a> 함수의 캡슐화</h4> <p>가령 다음과 같은 함수를 작성한다고 가정해보자.</p> <div class="language- extra-class"><pre><code>&quot;I am XXX. I live in XXX. I am XX years old&quot;
XX 부분은 사용자에게 인자로 받아 출력하는 함수
</code></pre></div><p>일단 그냥 짜보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> buff <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'I am'</span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token punctuation">,</span> <span class="token string">'I live in'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'I am'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'years old'</span><span class="token punctuation">]</span>
<span class="token keyword">function</span> <span class="token function">getStr</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> city<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    buff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> name
    buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> city
    buff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> age
    <span class="token keyword">return</span> buff<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token function">getStr</span><span class="token punctuation">(</span><span class="token string">'Jeong'</span><span class="token punctuation">,</span> <span class="token string">'GangNam'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>Warning❗️</code> 위의 코드는 buff가 전역 변수로 외부에 노출되어 있다. 따라서 다른 함수에서 접근 할수도 있고 같은 이름의 변수가 생성되면 버그가 생길수도 있다.</p> <p>클로저를 활용하여 문제를 해결해보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> getStr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> buff <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'I am'</span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token punctuation">,</span> <span class="token string">'I live in'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'I am'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'years old'</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> city<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        buff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> name
        buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> city
        buff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> age
        <span class="token keyword">return</span> buff<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token function">getStr</span><span class="token punctuation">(</span><span class="token string">'Jeong'</span><span class="token punctuation">,</span> <span class="token string">'GangNam'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>위의 함수의 특이점은 <strong>getStr 변수</strong>에 익명의 즉시 실행 함수로 반환되는 <strong>함수를 할당</strong>한다. 이 함수는 즉시 실행 함수의 <code>클로저</code>가 되고 <strong>자유변수 buff를 스코프 체인에서 참조</strong>할 수 있다.</p> <h4 id="settimeout-에-지정되는-함수"><a href="#settimeout-에-지정되는-함수" class="header-anchor">#</a> setTimeout()에 지정되는 함수</h4> <p>setTimeout 함수는 웹 브라우저에서 제공하는 함수이다.</p> <p>첫 번째 인자를 함수로, 두 번째 인자를 시간 간격으로 해당 함수를 호출한다. setTimeout()으로 자신의 코드를 호출하고 싶다면 첫 번째 인자로 해당 함수 객체의 참조를 넘겨주면 되지만, 함수에 인자를 줄 수 없다. 클로저로 해결해보자 !</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">callLater</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">[</span><span class="token string">'sum'</span><span class="token punctuation">]</span> <span class="token operator">=</span> a <span class="token operator">+</span> b
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span><span class="token string">'sum'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> sumObj <span class="token operator">=</span> <span class="token punctuation">{</span>
    sum <span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> func <span class="token operator">=</span> <span class="token function">callLater</span><span class="token punctuation">(</span>sumObj<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>func 에 callLater 로 반환한 함수의 클로저를 setTimeout의 함수 첫 번쨰 인자로 넣어주어 해결 하였다.</p> <h4 id="클로저-주의-사항"><a href="#클로저-주의-사항" class="header-anchor">#</a> 클로저 주의 사항</h4> <ol><li>하나의 클로저가 여러 함수 객체의 스코프 체인에 들어가 있는 경우</li></ol> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">func1</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">++</span> x<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">func2</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">--</span>x<span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> exam <span class="token operator">=</span> <span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
exam<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
exam<span class="token punctuation">.</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>위의 예제에서 반환되는 객체에는 두개의 함수가 있는데 모두 자유 변수 x를 참조하기 때문에 각각의 함수가 모두 x 값을 바꿈을 항상 인지하자.</p> <ol start="2"><li>루프 안에서 클로저</li></ol> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">countSeconds</span> <span class="token punctuation">(</span> <span class="token parameter">howMany</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> howMany<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">countSeconds</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 4,4,4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>setTimeout 함수의 인자는 자유 변수 i를 참조한다. 하지만 이 함수가 실행되는 시점은 countSeconds() 함수의 실행이 종료된 이후이고, i 는 이미 4가 된 상태이다. 그러므로 모두 4가 출력된다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">countSeconds</span> <span class="token punctuation">(</span> <span class="token parameter">howMany</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> howMany<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">copy</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> copy <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">countSeconds</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 1,2,3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>이와 같이 자바스크립트 라이브러리를 만들고자 할 때 이에 대한 지식이 없으면 변수명 충돌, 성능 저하, 비효율적인 자원 활용등의 문제가 반드시 발생할 것이다. 충분히 공부하자!</p> <h2 id="_6장-객체지향-프로그래밍"><a href="#_6장-객체지향-프로그래밍" class="header-anchor">#</a> 6장. 객체지향 프로그래밍</h2> <h4 id="클래스-기반-언어-vs-프로토타입-기반-언어"><a href="#클래스-기반-언어-vs-프로토타입-기반-언어" class="header-anchor">#</a> 클래스 기반 언어 vs 프로토타입 기반 언어</h4> <p>클래스 기반의 언어는 클래스로 객체의 기본적인 형태와 기능을 정의하고, 생성자로 인스턴스를 만들어서 사용할 수 있다. JAVA, C++ 과 같은 언어가 이에 해당된다.</p> <p>이런 유형의 언어는 모든 인스턴스가 <strong>클래스에 정의된 대로 같은 구조이고 보통 런타임에 바꿀 수 없다</strong>. 하지만 이에 따라 <strong>정확성, 안정성, 예측성의 관점</strong>에서 프로토 타입 언어보다 <strong>좀 더 나은 결과를 보장</strong>한다.</p> <p>반면 프로토 타입 기반의 언어는 객체의 자료구조, 메서드 등을 동적으로 바꿀 수 있다. <strong>객체의 구조와 동작 방식 또한 동적으로 바꿀 수 있</strong>다는 장점이 있다.</p> <h4 id="클래스-생성자-메서드"><a href="#클래스-생성자-메서드" class="header-anchor">#</a> 클래스, 생성자, 메서드</h4> <p>C++, JAVA 는 class 라는 키워드를 제공하여 클래스를 만들 수 있다. 클래스와 같은 이름의 생성자를 구현한다. 하지만 자바스크립트에선 이러한 개념이 없다.</p> <p>자바스크립트에서는 <strong>모든게 객체</strong>이다. 따라서 <strong>클래스, 생성자, 메서드 모두 함수로 구현</strong> 한다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> arg
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">setName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> value
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> me <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'me'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> you <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'you'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> him <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'him'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>위와 같이 클래스를 구현하면 Person 함수가 클래스이자 생성자의 역할을 한다. 하지만 주의 해야될 점이 있다.</p> <img src="https://www.plantuml.com/plantuml/svg/RP1B3i8m30NtEONL4rJYKvOz0U8ALckr5Ks2xBGLGjmT8nnWaLtcMJEBj9AGq-9d9zSft93HWuyXTYD7Jy2q4WivwN0cQEeQjgbFerCh4Lpq5WCy30DwigTGElzeC7eQQpWxrLkg00NMNPvC_gpxl0x_w-7RkiUb53iMOqqnTj9OIw7NNtW1" alt="uml diagram"> <p>각 객체는 자기 영역에서 공통적으로 사용할 수 있는 setName() 함수와 getName() 함수를 따로 생성하고 있다. 즉, <strong>자원 낭비</strong>를 가져온다. 아래 그림을 보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> arg
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value
<span class="token punctuation">}</span>
<span class="token keyword">var</span> me <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'me'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> you <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'you'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><img src="https://www.plantuml.com/plantuml/svg/RP3T2eCm34Rl-nJ1Uq7Otztm2SPUeMYOCjkKD3faxDqNMUqcx3BdEryRKaUnBACRJBptFbYs3XnvQZecXy0u8KSqiR43mgcguD6tqXbj2S9LC_BmJAEt3itBf4dRQr0iIG4smhHJuGDd6ly9nom49Y6P0sRhXdB9uc6byPVkjPxMAilpzmsZwsp1yl-MrEXRlSGR" alt="uml diagram"> <p>Person 함수 객체의 prototype 프로퍼티에 함수 getName(), setName() 함수를 정의하면 각 객체는 각자 따로 함수 객체를 생성할 필요 없이 프로토 타입 체인으로 접근할 수 있다.</p> <p>더글라스 크락포트는 다음과 같은 메서드 정의 방법을 제시한다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">method</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> func
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="상속"><a href="#상속" class="header-anchor">#</a> 상속</h4> <p>자바스크립트는 클래스를 기반으로 하는 전통적인 상속을 지원하지 않는다. 따라서 다음과 같이 두 가지 방법으로 상속을 흉내낼 수 있다.</p> <div class="language- extra-class"><pre><code>1. 프로토 타입을 이용한 상속 Prototypal Inheritance
2. 클래스 기반 상속
</code></pre></div><p>먼저 더글라스 크락포트가 소개한 자바스크립트에서 프로토 타입을 이용한 상속을 보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">create_child</span> <span class="token punctuation">(</span><span class="token parameter">parent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">F</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 1. 빈 함수 객체를 만들고</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> parent <span class="token comment">// 2. prototype 프로퍼티에 인자로 들어온 객체를 참조</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// F 함수 생성자로 하는 새로운 객체 반환</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>이렇게 반환된 객체는 부모 객체의 프로퍼티에 접근할 수 있고, 자신만의 프로퍼티도 만들 수 있다.</p> <p>참고로 위와 같은 함수는 이해를 돕기위한 예제이고 JS에서 기본적으로 이를 제공하는데 바로 <code>Object.create()</code> 함수 이다.</p> <p>클래스 기반 상속 👉 일단 skip</p> <h4 id="캡슐화"><a href="#캡슐화" class="header-anchor">#</a> 캡슐화</h4> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> arg <span class="token operator">?</span> arg <span class="token operator">:</span> <span class="token string">'zzoon'</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">getName</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> name
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">setName</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            name <span class="token operator">=</span> arg
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> me <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>me<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>위의 예제는 자바스크립트 라이브러리에서도 흔히 사용되는 <code>모듈 패턴</code>이다. Person 함수로부터 반환 받은 객체로 Person 함수의 private 멤버에 접근 할 수 있다.</p> <p>하지만 접근하는 private 멤버가 객체나 배열이면 <code>얕은 복사</code>로 참조만을 반환 하므로 사용자가 이후 이를 쉽게 변경할 수 있다.</p> <p>아래 예제를 보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">ArrCreate</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">getArr</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> arr
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">ArrCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">getArr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getARr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [1,2,3,5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>따라서 객체를 반환하는 경우 <code>깊은 복사</code>로 <strong>복사본을 반환</strong>하는 것이 좋다.</p> <p>이제 클로저를 이용하여 캡슐화를 적용해보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> arg <span class="token operator">?</span> arg <span class="token operator">:</span> <span class="token string">'zzoon'</span>
    <span class="token keyword">var</span> <span class="token function-variable function">Func</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">Func</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">getName</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> name
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">setName</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            name <span class="token operator">=</span> arg
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Func
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>위의 예제의 경우 클로저를 활용하여 name 에 접그할 수 없게 했다. 즉시 실행 함수로 반환되는 Func가 클로저가 되고 name 프로퍼티가 자유 변수가 되기 때문에
사용자는 name에 대한 접근이 불가능하다.</p> <h2 id="_7장-함수형-프로그래밍"><a href="#_7장-함수형-프로그래밍" class="header-anchor">#</a> 7장. 함수형 프로그래밍</h2> <h3 id="함수형-프로그래밍이란"><a href="#함수형-프로그래밍이란" class="header-anchor">#</a> 함수형 프로그래밍이란?</h3> <p>자바스크립트는 함수형 프로그래밍에서 제시하는 방법론 중 일부는 구현 가능하지만 순수한 함수형 프로그래밍 언어는 아니다.</p> <p>함수형 프로그래밍은 함수의 조합으로 작업을 수행한다. 중요한 점은 이 작업이 이루어지는 동안 <strong>작업에 필요한 데이터와 상태는 변하지 않는다는 점</strong>이다. <strong>변하는건 오직 함수</strong>뿐이다.</p> <p>다음 함수형 프로그래밍 슈도코드를 보자</p> <p>특정 문자열을 암호화 하는 함수가 여러개 있다. f1, f2, f3 모두 함수.</p> <div class="language- extra-class"><pre><code>f1 = encrypt1
f2 = encrypt2
f3 = encrypt3
</code></pre></div><p>pure_value = 'jeong' 👉 암호화할 문자열</p> <p>encrypted_value = get_encrypted(x) 👉 암호화 된 문자열 이라 가정하면</p> <div class="language- extra-class"><pre><code>encrypted_value1 = get_encrypted(f1)
encrypted_value2 = get_encrypted(f2)
encrypted_value3 = get_encrypted(f3)
</code></pre></div><p>와 같이 실행할 수 있다. 이때 pure_value 작업이 이루어지는 동안 <strong>변하지 않는다</strong>
변하는건 입력으로 들어오는 함수 f1, f2, f3가 된다.</p> <p>f1, f2, f3는 외부 (pure_value 변수) 에 아무런 영향을 미치지 않는 함수이다. 이를 <code>순수 함수 pure function</code> 라고 한다.
즉, 순수 함수로 다른 작업에 활용해도 문제가 없다.</p> <p>get_encryped() 함수는 결과 값이 encrypted_value 라는 값이지만 결과 값을 또 다른 형태의 함수로 반환 할 수도 있다.
이 함수처럼 <strong>함수를 또 하나의 값으로 간주하여 함수의 인자 혹은 반환 값으로 사용할 수 있는 함수</strong>를 <code>고계함수 higher order function</code> 라고 한다.</p> <div class="custom-block tip"><p class="custom-block-title">명령형 vs 함수형 프로그래밍</p> <p>함수형 프로그래밍에 반대되는 개념이 <code>명령형 프로그래밍 Imperative Programming</code> 이다. C 언어가 이에 해당된다. 명령형은 컴퓨터가 수행할 일의 명령을 순서대로 기술하는 프로그래밍 방식이다.</p> <p>명령형 프로그래밍은 입력 출력을 계산하는 순수한 함수와 특정 작업을 수행하는 여러 가지 명령어로 이루어진 함수도 있다. 이를 <code>프로시저 procedure</code> 라 한다. 프로시저는 함수평 프로그래밍의 순수 함수와는 목적 자체가 다르다.</p> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;print this to screen\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>printf() 함수 역시 입력 값과 출력 값이 있지만 printf()의 목적은 화면에 출력하는게 함수의 목적이다. 결과 값은 단지 제대로 수행되었는지 여부만 따진다.</p> <p>이처럼 명령형 프로그래밍은 <strong>함수가 특정 작업의 순차적인 명령을 기술하는 데 중점</strong>을 둔다.</p> <p>반면에 함수형 프로그래밍은 함수가 순수 함수로서 외부에 아무런 영향을 주지 않는 선에서 <strong>자신의 로직을 처리하여 결과를 반환</strong>하여 함수의 목적이 결과 값 반환에 있다.</p></div> <h3 id="js에서의-함수형-프로그래밍"><a href="#js에서의-함수형-프로그래밍" class="header-anchor">#</a> JS에서의 함수형 프로그래밍</h3> <p>자바스크립트는 다음 두가지 덕분에 함수형 프로그래밍이 일부 구현 가능하다</p> <div class="language- extra-class"><pre><code>1. 일급 객체로서의 함수
2. 클로저
</code></pre></div><p>몇가지 코드로 이해해보자.</p> <h4 id="배열의-각-원소-총합-구하기"><a href="#배열의-각-원소-총합-구하기" class="header-anchor">#</a> 배열의 각 원소 총합 구하기</h4> <p>먼저 명령형 프로그래밍 방식으로 구현한 코드를 보자</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span> <span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length
    <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        sum <span class="token operator">+=</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> sum
<span class="token punctuation">}</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token function">sum</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token comment">// 10</span>

<span class="token keyword">function</span> <span class="token function">multiply</span> <span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        result <span class="token operator">+=</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token function">multiply</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token comment">// 24</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>문제 하나하나 각각의 함수를 구현하여 풀이한다. 또 배열의 원소를 다른 방식으로 계산하러면 새로운 함수가 필요하다.</p> <p>함수형 프로그래밍으로 다시 작성해보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> memo</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> acc <span class="token operator">=</span> memo
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        acc <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> acc
<span class="token punctuation">}</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">multipy</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> y
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">reduce</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">reduce</span><span class="token punctuation">(</span>multiply<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>이와 같이 함수형 프로그래밍을 통하여 더욱 높은 모듈화를 이룰 수 있다.</p> <h4 id="팩토리얼"><a href="#팩토리얼" class="header-anchor">#</a> 팩토리얼</h4> <p>일반적으로 명령형 프로그래밍으로 재귀호출 방식으로 구현한다면 아래와 같이 구현 할 수 있다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fact</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">===</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> num <span class="token operator">*</span> <span class="token function">fact</span> <span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fact</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>하지만 함수형 프로그래밍을 이용하면 중복된 연산을 줄임으로써 성능을 향상 시킬 수 있다.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">fact</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'0'</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            result <span class="token operator">=</span> cache <span class="token punctuation">[</span>n<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> cache <span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> n <span class="token operator">*</span> <span class="token function">func</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> func<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fact</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fact</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>fact 는 자유 변수 cache에 접근 할 수 있는 클로저를 반환 받는다. 클로저로 숨겨지는 cache 에는 팩토리얼 연산 값을 저장한다. 즉, 연산과정에서 캐시에 저장된 값이 있으면 즉시 그 값이 반환 된다. 이를 <code>memoization 패턴</code> 이라 한다.</p> <h4 id="피보나치-수열"><a href="#피보나치-수열" class="header-anchor">#</a> 피보나치 수열</h4> <p>memoization 패턴을 이용해서 피보나치 수열을 구현해보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">fibo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'0'</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'1'</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            result <span class="token operator">=</span> cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">func</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> func
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>앞의 예제와 비슷하게 클로저를 이용하여 cache를 캐시로 활용한다.</p> <p>이를 활용하여 팩토리얼과 피보나치 수열을 계산하는 함수를 인자로 받는 함수를 구현해보자</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">cacher</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cache<span class="token punctuation">,</span> func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token function-variable function">calc</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            result <span class="token operator">=</span> cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span>calculate<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> calc
<span class="token punctuation">}</span>

<span class="token keyword">var</span> fact <span class="token operator">=</span> <span class="token function">cacher</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'0'</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token function">func</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> fibo <span class="token operator">=</span> <span class="token function">cacher</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'0'</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'1'</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">func</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">func</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>위와 같이 함수형 프로그래밍으로 코드를 구현하는 감을 익히도록 해보자.</p> <p><code>커링</code></p> <p>커링이란 특정 함수에서 정의된 인자의 일부를 넣어 고정시키고, 나머지 인자를 받는 새로운 함수를 만드는 것을 의미한다.</p> <p>커링은 함수형 프로그래밍 언어에서 기본적으로 지원하지만 JS에서는 기본으로 제공하지는 않는다. 따라서 사용자는 다음과 같이 Function.prototype에 커링 함수를 정의하여 사용할 수 있다. 아래 코드를 보자.</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">curry</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_8-jquery-소스-코드-분석"><a href="#_8-jquery-소스-코드-분석" class="header-anchor">#</a> 8. jQuery 소스 코드 분석</h2></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/JeongShin_Blog/book-review/CoreJS/" class="prev">
        코어 자바스크립트
      </a></span> <span class="next"><a href="/JeongShin_Blog/book-review/EasyDB/">
        가장 쉬운 데이터베이스 설계
      </a>
      →
    </span></p></div>  <div><div id="comment"></div></div></main> <footer class="siteFooter">
  COPYRIGHT©2020 ALL RIGHT JeongShin
  <br>sjeong1127@gmail.com . +82-10-2169-2142 .
  <br> <a href="https://www.instagram.com/jeongshin96/" target="_blank">Instagram</a> <a href="https://github.com/JeongShin" target="_blank">GitHub</a></footer></div><div class="global-ui"></div></div>
    <script src="/JeongShin_Blog/assets/js/app.9d2f8fc0.js" defer></script><script src="/JeongShin_Blog/assets/js/2.d8f4ba08.js" defer></script><script src="/JeongShin_Blog/assets/js/25.6c5e6b29.js" defer></script>
  </body>
</html>
